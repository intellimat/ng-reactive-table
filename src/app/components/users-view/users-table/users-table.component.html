<form [formGroup]="tableForm">
  <table
    mat-table
    [dataSource]="data"
    class="mat-elevation-z8"
    formArrayName="tableRows"
  >
    <!-- Id Column -->
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>Id</th>
      <td mat-cell *matCellDef="let element">
        {{ element.id }}
      </td>
    </ng-container>

    <!-- Name Column -->
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td
        mat-cell
        *matCellDef="let element; let i = index"
        class="align-vertical-center"
        [formGroupName]="i"
      >
        <!-- {{ element.name }} -->
        <mat-form-field>
          <input matInput value="element.name" formControlName="name" />
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Email Column -->
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef>Email</th>
      <td
        mat-cell
        *matCellDef="let element; let i = index"
        class="align-vertical-center"
        [formGroupName]="i"
      >
        <!-- {{ element.email }} -->
        <mat-form-field>
          <input matInput value="element.email" formControlName="email" />
          <mat-error *ngIf="true">Not valid email</mat-error>
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Department Column -->
    <ng-container matColumnDef="department">
      <th mat-header-cell *matHeaderCellDef>Department</th>
      <td
        mat-cell
        *matCellDef="let element; let i = index"
        class="align-vertical-center"
        [formGroupName]="i"
      >
        <!-- {{ element.department }} -->
        <mat-form-field>
          <input
            matInput
            value="element.department"
            formControlName="department"
          />
        </mat-form-field>
      </td>
    </ng-container>

    <!-- Operations Column -->
    <ng-container matColumnDef="operations">
      <th mat-header-cell *matHeaderCellDef>Operations</th>
      <td mat-cell *matCellDef="let element">
        <button mat-icon-button aria-label="Edit row">
          <mat-icon
            aria-hidden="false"
            aria-label="Edit row"
            fontIcon="edit"
          ></mat-icon>
        </button>
        <button mat-icon-button aria-label="Delete row">
          <mat-icon
            aria-hidden="false"
            aria-label="Delete row"
            fontIcon="delete"
          ></mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    <!-- </ng-container> -->
  </table>
</form>
